<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Progress reporting</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="madalgo-doxygen.css" rel="stylesheet" type="text/css"/>
<link href="printstyle.css" rel="stylesheet" type="text/css" media="print" />
</head>
<body>
<div id="top">
<div id="titlearea">
<h1 id="projectname">TPIE</h1>
<span class="version"><a href="//github.com/thomasmoelhave/tpie/tree/4739728">4739728</a></span>
</div>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('progress.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Progress reporting </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>TPIE has a couple classes for reporting progress to the user. The central concept is the progress_indicator, fleshed out in <a class="el" href="classtpie_1_1progress__indicator__base.html">tpie::progress_indicator_base</a>. A progress indicator must have the methods init(stream_size_type steps), step() and done(). It should inherit from the virtual base class <a class="el" href="classtpie_1_1progress__indicator__base.html">tpie::progress_indicator_base</a>.</p>
<p>The simplest way of reporting progress is settling on a concrete progress indicator, for instance <a class="el" href="classtpie_1_1progress__indicator__arrow.html">tpie::progress_indicator_arrow</a>, and passing around pointers or references to this in your code. You may then call init() once with the number of items to process and step() for each item and finally done() when you have completed processing. The following piece of code is from the file <code>example/helloworld.cpp</code> (albeit slightly modified).</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> populate_stream(<a class="code" href="classtpie_1_1file__stream.html">tpie::file_stream&lt;size_t&gt;</a> &amp; writer) {</div>
<div class="line">    <span class="comment">// The parameter to init tells the PI how many times we will call step().</span></div>
<div class="line">    <a class="code" href="classtpie_1_1progress__indicator__arrow.html">tpie::progress_indicator_arrow</a> progress_writer(<span class="stringliteral">&quot;Populate stream&quot;</span>, s);</div>
<div class="line">    progress_writer.init(s);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; s; ++i) {</div>
<div class="line">        <span class="comment">// Write a single item</span></div>
<div class="line">        writer.write((i * y) % s);</div>
<div class="line">        progress_writer.step();</div>
<div class="line">    }</div>
<div class="line">    progress_writer.done();</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="fractional"></a>
Fractional progress reporting</h1>
<p>Often, you will divide your algorithm into several sequential steps. In this case, you may choose to have more than one progress indicator. If you wish to display just a single progress bar showing the total progress towards the goal, TPIE provides a fractional progress indicator implementation.</p>
<p>A fractional progress indicator wraps another progress indicator and provides as many fractional subindicators as the user needs. A fractional subindicator adheres to the progress indicator concept. Behind the scenes, the fractional progress indicator measures the time it takes each step of the algorithm to complete. Using the execution time predictor, over several runs of the algorithm it will become better at predicting the amount of time each subindicator spends. In the simplest case, a program will first write items to a stream, and then read them back. Using a fractional progress indicator, TPIE will eventually figure out the ratio of time spent between reading and writing. Eventually, the amount of progress reported to the user will increase linearly with wall clock time.</p>
<p>The following example is taken from the file <code>example/helloworld.cpp</code>. </p><div class="fragment"><div class="line">progress_indicator_arrow pi(<span class="stringliteral">&quot;Hello world&quot;</span>, elements);</div>
<div class="line">fractional_progress fp(&amp;pi);</div>
<div class="line"> </div>
<div class="line">fractional_subindicator progress_writer(fp, <span class="stringliteral">&quot;Writer&quot;</span>, <a class="code" href="fractional__progress_8h.html#a63529a42767e2b1fb6cbc269acbf12f6">TPIE_FSI</a>, elements, <span class="stringliteral">&quot;Writer&quot;</span>);</div>
<div class="line">fractional_subindicator progress_sort(fp, <span class="stringliteral">&quot;Sort&quot;</span>, <a class="code" href="fractional__progress_8h.html#a63529a42767e2b1fb6cbc269acbf12f6">TPIE_FSI</a>, elements, <span class="stringliteral">&quot;Sort&quot;</span>);</div>
<div class="line"> </div>
<div class="line">fp.init();</div>
<div class="line">write_number_stream(progress_writer);</div>
<div class="line">sort_number_stream(progress_sort);</div>
<div class="line">fp.done();</div>
</div><!-- fragment --><h1><a class="anchor" id="dummyprogress"></a>
Disabling progress reporting</h1>
<p>There are two ways in which you may optionally disable progress reporting at runtime.</p>
<p>The first is polymorphically. If you pass around pointers to the progress_indicator_base class, you may instantiate <a class="el" href="classtpie_1_1progress__indicator__null.html" title="a dummy progress indicator that produces no output">tpie::progress_indicator_null</a> rather than, say, <a class="el" href="classtpie_1_1progress__indicator__arrow.html">tpie::progress_indicator_arrow</a>. This is a virtual null object implementation of the progress indicator base class. Although no progress is reported, you still pay the price of a virtual method call for each call to step().</p>
<p>The second is using templates. TPIE provides a light-weight null object implementation of the progress indicator <b>concept</b> called <a class="el" href="structtpie_1_1dummy__progress__indicator.html" title="A progress indicator that is conceptually compatible with tpie::progress_indicator_base and tpie::fra...">tpie::dummy_progress_indicator</a>. This, in conjunction with the <a class="el" href="structtpie_1_1progress__types.html" title="For applications where you wish to disable progress indicators via a template parameter,...">tpie::progress_types</a> helper class and a boolean template parameter indicating whether to report progress or not, allows you to generate two versions of code at compile time: One with progress enabled, and one without.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dummy__progress_8h.html">tpie/dummy_progress.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="types_8h.html">tpie/types.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="progress__indicator__arrow_8h.html">tpie/progress_indicator_arrow.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="classtpie_1_1file__stream.html">tpie::file_stream&lt;int&gt;</a> fs;</div>
<div class="line">tpie::uint64_t item_count;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> use_progress&gt;</div>
<div class="line"><span class="keywordtype">void</span> scanner(<span class="keyword">typename</span> <a class="code" href="classtpie_1_1progress__indicator__base.html">tpie::progress_types&lt;use_progress&gt;::base</a> * pi) {</div>
<div class="line">    pi-&gt;<a class="code" href="classtpie_1_1progress__indicator__base.html#aafe6fd9253a95046455d42584723e2bf">init</a>(item_count);</div>
<div class="line">    <span class="keywordflow">for</span> (tpie::uint64_t i = 0; i &lt; item_count; ++i) {</div>
<div class="line">        fs.<a class="code" href="classtpie_1_1file__stream.html#af5f0c0a38832561a99d1478377cd1eb9">read</a>();</div>
<div class="line">        pi-&gt;<a class="code" href="classtpie_1_1progress__indicator__base.html#a292d1a9b1cd642d967c662e62d4ea8f6">step</a>();</div>
<div class="line">    }</div>
<div class="line">    pi-&gt;<a class="code" href="classtpie_1_1progress__indicator__base.html#af9f171e8c2fb1a63e4652ea3a063d627">done</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> scanner_optional_progress(<span class="keywordtype">bool</span> use_progress) {</div>
<div class="line">    <span class="keywordflow">if</span> (use_progress) {</div>
<div class="line">        <a class="code" href="classtpie_1_1progress__indicator__arrow.html">tpie::progress_indicator_arrow</a> pi(<span class="stringliteral">&quot;Hello world&quot;</span>, item_count);</div>
<div class="line">        scanner&lt;true&gt;(&amp;pi);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code" href="structtpie_1_1dummy__progress__indicator.html">tpie::dummy_progress_indicator</a> pi;</div>
<div class="line">        scanner&lt;false&gt;(&amp;pi);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Since dummy_progress_indicator has non-virtual, inline implementations of the init, step and done methods, we save a lot of CPU work at run time when the user wishes to disable progress reporting. However, twice the amount of code is generated, which may lead to more frequent cache misses, which can incur performance penalty at run time. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="aclasstpie_1_1progress__indicator__base_html"><div class="ttname"><a href="classtpie_1_1progress__indicator__base.html">tpie::progress_indicator_base</a></div><div class="ttdoc">The base class for indicating the progress of some task.</div><div class="ttdef"><b>Definition:</b> <a href="progress__indicator__base_8h_source.html#l00062">progress_indicator_base.h:62</a></div></div>
<div class="ttc" id="atypes_8h_html"><div class="ttname"><a href="types_8h.html">types.h</a></div></div>
<div class="ttc" id="aclasstpie_1_1file__stream_html_af5f0c0a38832561a99d1478377cd1eb9"><div class="ttname"><a href="classtpie_1_1file__stream.html#af5f0c0a38832561a99d1478377cd1eb9">tpie::file_stream::read</a></div><div class="ttdeci">const T &amp; read()</div><div class="ttdoc">Reads next item from stream if can_read() == true.</div><div class="ttdef"><b>Definition:</b> <a href="compressed_2stream_8h_source.html#l00425">stream.h:425</a></div></div>
<div class="ttc" id="aclasstpie_1_1file__stream_html"><div class="ttname"><a href="classtpie_1_1file__stream.html">tpie::file_stream</a></div><div class="ttdoc">Compressed stream.</div><div class="ttdef"><b>Definition:</b> <a href="compressed_2predeclare_8h_source.html#l00049">predeclare.h:49</a></div></div>
<div class="ttc" id="afractional__progress_8h_html_a63529a42767e2b1fb6cbc269acbf12f6"><div class="ttname"><a href="fractional__progress_8h.html#a63529a42767e2b1fb6cbc269acbf12f6">TPIE_FSI</a></div><div class="ttdeci">#define TPIE_FSI</div><div class="ttdef"><b>Definition:</b> <a href="fractional__progress_8h_source.html#l00038">fractional_progress.h:38</a></div></div>
<div class="ttc" id="aclasstpie_1_1progress__indicator__arrow_html"><div class="ttname"><a href="classtpie_1_1progress__indicator__arrow.html">tpie::progress_indicator_arrow</a></div><div class="ttdef"><b>Definition:</b> <a href="progress__indicator__arrow_8h_source.html#l00037">progress_indicator_arrow.h:37</a></div></div>
<div class="ttc" id="aclasstpie_1_1progress__indicator__base_html_a292d1a9b1cd642d967c662e62d4ea8f6"><div class="ttname"><a href="classtpie_1_1progress__indicator__base.html#a292d1a9b1cd642d967c662e62d4ea8f6">tpie::progress_indicator_base::step</a></div><div class="ttdeci">void step(stream_size_type step=1)</div><div class="ttdoc">Record an increment to the indicator and advance the indicator.</div><div class="ttdef"><b>Definition:</b> <a href="progress__indicator__base_8h_source.html#l00091">progress_indicator_base.h:91</a></div></div>
<div class="ttc" id="aclasstpie_1_1progress__indicator__base_html_aafe6fd9253a95046455d42584723e2bf"><div class="ttname"><a href="classtpie_1_1progress__indicator__base.html#aafe6fd9253a95046455d42584723e2bf">tpie::progress_indicator_base::init</a></div><div class="ttdeci">virtual void init(stream_size_type range=0)</div><div class="ttdoc">Initialize progress indicator.</div><div class="ttdef"><b>Definition:</b> <a href="progress__indicator__base_8h_source.html#l00121">progress_indicator_base.h:121</a></div></div>
<div class="ttc" id="adummy__progress_8h_html"><div class="ttname"><a href="dummy__progress_8h.html">dummy_progress.h</a></div></div>
<div class="ttc" id="aprogress__indicator__arrow_8h_html"><div class="ttname"><a href="progress__indicator__arrow_8h.html">progress_indicator_arrow.h</a></div></div>
<div class="ttc" id="aclasstpie_1_1progress__indicator__base_html_af9f171e8c2fb1a63e4652ea3a063d627"><div class="ttname"><a href="classtpie_1_1progress__indicator__base.html#af9f171e8c2fb1a63e4652ea3a063d627">tpie::progress_indicator_base::done</a></div><div class="ttdeci">virtual void done()</div><div class="ttdoc">Advance the indicator to the end.</div><div class="ttdef"><b>Definition:</b> <a href="progress__indicator__base_8h_source.html#l00130">progress_indicator_base.h:130</a></div></div>
<div class="ttc" id="astructtpie_1_1dummy__progress__indicator_html"><div class="ttname"><a href="structtpie_1_1dummy__progress__indicator.html">tpie::dummy_progress_indicator</a></div><div class="ttdoc">A progress indicator that is conceptually compatible with tpie::progress_indicator_base and tpie::fra...</div><div class="ttdef"><b>Definition:</b> <a href="dummy__progress_8h_source.html#l00083">dummy_progress.h:83</a></div></div>
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
      <li class="footer">from TPIE 4739728 (<a href="//github.com/thomasmoelhave/tpie/tree/4739728">browse source</a>). Generated on Mon May 23 2022 23:38:36 by
<a href="http://www.doxygen.org/index.html">Doxygen</a> 1.8.17 </li>
    </ul>
  </div>
</body>
</html>
