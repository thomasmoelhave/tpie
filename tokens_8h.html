<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>pipelining/tokens.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="madalgo-doxygen.css" rel="stylesheet" type="text/css"/>
<link href="printstyle.css" rel="stylesheet" type="text/css" media="print" />
</head>
<body>
<div id="top">
<div id="titlearea">
<h1 id="projectname">TPIE</h1>
<span class="version"><a href="//github.com/thomasmoelhave/tpie/tree/4739728">4739728</a></span>
</div>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('tokens_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#enum-members">Enumerations</a>  </div>
  <div class="headertitle">
<div class="title">tokens.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;tpie/tpie_export.h&gt;</code><br />
<code>#include &lt;<a class="el" href="exception_8h_source.html">tpie/exception.h</a>&gt;</code><br />
<code>#include &lt;tpie/pipelining/exception.h&gt;</code><br />
<code>#include &lt;<a class="el" href="pipelining_2predeclare_8h_source.html">tpie/pipelining/predeclare.h</a>&gt;</code><br />
<code>#include &lt;tpie/pipelining/container.h&gt;</code><br />
<code>#include &lt;<a class="el" href="types_8h_source.html">tpie/types.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="tpie__assert_8h_source.html">tpie/tpie_assert.h</a>&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;boost/intrusive_ptr.hpp&gt;</code><br />
<code>#include &lt;boost/optional.hpp&gt;</code><br />
<code>#include &lt;unordered_map&gt;</code><br />
<code>#include &lt;unordered_set&gt;</code><br />
</div>
<p><a href="tokens_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtpie_1_1pipelining_1_1bits_1_1node__map.html">tpie::pipelining::bits::node_map</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtpie_1_1pipelining_1_1bits_1_1node__map_1_1pipe__base__forward__t.html">tpie::pipelining::bits::node_map::pipe_base_forward_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtpie_1_1pipelining_1_1node__token.html">tpie::pipelining::node_token</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacetpie"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetpie.html">tpie</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacetpie_1_1pipelining"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetpie_1_1pipelining.html">tpie::pipelining</a></td></tr>
<tr class="memdesc:namespacetpie_1_1pipelining"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="factory__base_8h_source.html">pipelining/factory_base.h</a> Base class of pipelining factories <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a14f8bec67217ca0c879e72859784e7a6"><td class="memItemLeft" align="right" valign="top"><a id="a14f8bec67217ca0c879e72859784e7a6"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>node_relation</b> { <br />
&#160;&#160;<b>pushes</b>, 
<b>pulls</b>, 
<b>depends</b>, 
<b>no_forward_depends</b>, 
<br />
&#160;&#160;<b>memory_share_depends</b>
<br />
 }</td></tr>
<tr class="separator:a14f8bec67217ca0c879e72859784e7a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Pipeline tokens.</p>
<h1><a class="anchor" id="sec_pipegraphs"></a>
The two pipeline graphs</h1>
<p>A pipeline consists of several nodes. Each node either produces, transforms or consumes items. One node may push items to another node, and it may pull items from another node, and it may depend implicitly on the execution of another node. For instance, to reverse an item stream using two nodes, one node will write items to a file_stream, and the other will read them in backwards. Thus, the second node depends on the first, but it does not directly push to or pull from it.</p>
<p>To a pipeline graph we associate two different directed edge sets.</p>
<p>The <em>item flow graph</em> is a directed acyclic graph, and edges go from producer towards consumer, regardless of push/pull kind.</p>
<p>The <em>actor graph</em> is a directed graph where edges go from actors, so a node has an edge to another node if the corresponding node either pushes to or pulls from the other corresponding node.</p>
<p>The item flow graph is useful for transitive dependency resolution and execution order decision. The actor graph is useful for presenting the pipeline flow to the user graphically.</p>
<h2><a class="anchor" id="sub_pipegraphimpl"></a>
Implementation</h2>
<p>Since nodes are copyable, we cannot store node pointers limitlessly, as pointers will change while the pipeline is being constructed. Instead, we associate to each node a token (numeric id) that is copied with the node. The node_token class signals the mapping from numeric ids to node pointers to a node_map.</p>
<p>However, we do not want a global map from ids to node pointers, as an application may construct many pipelines throughout its lifetime. To mitigate this problem, each node_map is local to a pipeline, and each node_token knows (directly or indirectly) which node_map currently holds the mapping of its id to its node.</p>
<p>When we need to connect one node to another in the pipeline graphs, we need the two corresponding node_tokens to share the same node_map. When we merge two node_maps, the mappings in one are copied to the other, and one node_map remembers that it has been usurped by another node_map. This corresponds to the set representative in a union-find data structure, and we implement union-find merge by rank. We use Boost smart pointers to deallocate node_maps when they are no longer needed. </p>

<p class="definition">Definition in file <a class="el" href="tokens_8h_source.html">tokens.h</a>.</p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
      <li class="footer">from TPIE 4739728 (<a href="//github.com/thomasmoelhave/tpie/tree/4739728">browse source</a>). Generated on Mon May 23 2022 23:38:36 by
<a href="http://www.doxygen.org/index.html">Doxygen</a> 1.8.17 </li>
    </ul>
  </div>
</body>
</html>
